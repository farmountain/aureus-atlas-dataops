# Approval Runs Evidence

This directory contains evidence artifacts for approval workflows, demonstrating compliance with Evidence-Gated Development (EGD) and AUREUS control principles.

## Directory Structure

```
approval_runs/
├── README.md (this file)
├── sample_approval_lifecycle.json (example complete lifecycle)
├── {approval_id}_request.json (approval request evidence)
├── {approval_id}_approved_and_executed.json (approval + execution evidence)
└── {approval_id}_rejected.json (rejection evidence)
```

## Evidence Pack Contents

Each evidence pack includes:

### Request Stage (`{approval_id}_request.json`)
- Approval ID and evidence pack ID
- Request timestamp
- Requester information (name, role)
- Action type and description
- Risk level assessment
- Action context (environment, metadata)
- Action payload (what will be executed)
- Audit event IDs (at least 1 for the request)

### Approved and Executed Stage (`{approval_id}_approved_and_executed.json`)
- All request stage information
- Approver information (name, role)
- Approval timestamp and comment
- Snapshot ID (pre-execution state)
- Execution result details
- All audit event IDs (request + approval + execution)

### Rejected Stage (`{approval_id}_rejected.json`)
- All request stage information
- Approver information (name, role)
- Rejection timestamp and comment
- All audit event IDs (request + rejection)

## Compliance Controls

All approval workflows enforce:

1. **Policy Checks**: Every request evaluated against active policies
2. **Audit Logging**: Immutable audit trail for all approval lifecycle events
3. **Snapshots**: Pre-execution snapshots for rollback capability
4. **Role-Based Authorization**: Only `approver` or `admin` roles can approve/reject
5. **Evidence Generation**: Complete evidence pack at each lifecycle stage

## High-Risk Actions Requiring Approval

- **prod_deploy**: Deployments to production environment
- **policy_change**: Modifications to governance policies
- **pii_access_high**: Access to datasets with high PII level

## Usage

Evidence packs are automatically generated by the `ApprovalService` and written to this directory. Reference the approval ID or evidence pack ID for audit and compliance reporting.
