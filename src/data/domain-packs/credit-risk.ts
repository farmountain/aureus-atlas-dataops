import type { DomainPack } from './types'

export const creditRiskPack: DomainPack = {
  domain: 'Credit Risk',
  description: 'Credit risk portfolio monitoring and management',
  datasets: [
    {
      id: 'cr_loan_portfolio',
      name: 'Loan Portfolio',
      description: 'Master loan portfolio with current balances, ratings, and borrower information',
      domain: 'Credit Risk',
      owner: 'Credit Risk Analytics Team',
      piiLevel: 'HIGH',
      jurisdiction: 'US',
      freshnessSLA: 'DAILY',
      sampleRowCount: 50000,
      columns: [
        {
          name: 'loan_id',
          type: 'string',
          description: 'Unique loan identifier',
          nullable: false,
        },
        {
          name: 'borrower_id',
          type: 'string',
          description: 'Unique borrower identifier',
          nullable: false,
          pii: true,
        },
        {
          name: 'loan_type',
          type: 'string',
          description: 'Type of loan (MORTGAGE, AUTO, PERSONAL, COMMERCIAL)',
          nullable: false,
        },
        {
          name: 'origination_date',
          type: 'date',
          description: 'Date loan was originated',
          nullable: false,
        },
        {
          name: 'maturity_date',
          type: 'date',
          description: 'Loan maturity date',
          nullable: false,
        },
        {
          name: 'original_amount',
          type: 'decimal',
          description: 'Original loan amount in USD',
          nullable: false,
        },
        {
          name: 'current_balance',
          type: 'decimal',
          description: 'Current outstanding balance in USD',
          nullable: false,
        },
        {
          name: 'interest_rate',
          type: 'decimal',
          description: 'Annual interest rate (percentage)',
          nullable: false,
        },
        {
          name: 'risk_rating',
          type: 'string',
          description: 'Internal risk rating (AAA, AA, A, BBB, BB, B, CCC, CC, C, D)',
          nullable: false,
        },
        {
          name: 'days_past_due',
          type: 'integer',
          description: 'Number of days payment is past due',
          nullable: false,
        },
        {
          name: 'npl_flag',
          type: 'boolean',
          description: 'Non-performing loan flag (>90 days past due)',
          nullable: false,
        },
        {
          name: 'collateral_value',
          type: 'decimal',
          description: 'Current collateral valuation in USD',
          nullable: true,
        },
        {
          name: 'ltv_ratio',
          type: 'decimal',
          description: 'Loan-to-value ratio (percentage)',
          nullable: true,
        },
        {
          name: 'probability_of_default',
          type: 'decimal',
          description: 'PD estimate (percentage)',
          nullable: false,
        },
        {
          name: 'loss_given_default',
          type: 'decimal',
          description: 'LGD estimate (percentage)',
          nullable: false,
        },
        {
          name: 'exposure_at_default',
          type: 'decimal',
          description: 'EAD amount in USD',
          nullable: false,
        },
        {
          name: 'expected_credit_loss',
          type: 'decimal',
          description: 'ECL amount in USD (IFRS 9)',
          nullable: false,
        },
        {
          name: 'industry_sector',
          type: 'string',
          description: 'Borrower industry sector (for commercial loans)',
          nullable: true,
        },
        {
          name: 'geographic_region',
          type: 'string',
          description: 'Geographic region of borrower',
          nullable: false,
        },
        {
          name: 'last_updated',
          type: 'timestamp',
          description: 'Last update timestamp',
          nullable: false,
        },
      ],
    },
    {
      id: 'cr_rating_migration',
      name: 'Credit Rating Migration Matrix',
      description: 'Historical credit rating transitions for migration analysis',
      domain: 'Credit Risk',
      owner: 'Credit Risk Analytics Team',
      piiLevel: 'NONE',
      jurisdiction: 'US',
      freshnessSLA: 'MONTHLY',
      sampleRowCount: 10000,
      columns: [
        {
          name: 'observation_date',
          type: 'date',
          description: 'Date of rating observation',
          nullable: false,
        },
        {
          name: 'loan_id',
          type: 'string',
          description: 'Loan identifier',
          nullable: false,
        },
        {
          name: 'from_rating',
          type: 'string',
          description: 'Previous rating',
          nullable: false,
        },
        {
          name: 'to_rating',
          type: 'string',
          description: 'Current rating',
          nullable: false,
        },
        {
          name: 'migration_days',
          type: 'integer',
          description: 'Days between rating changes',
          nullable: false,
        },
        {
          name: 'upgrade_flag',
          type: 'boolean',
          description: 'True if rating improved',
          nullable: false,
        },
        {
          name: 'downgrade_flag',
          type: 'boolean',
          description: 'True if rating worsened',
          nullable: false,
        },
      ],
    },
    {
      id: 'cr_concentration_limits',
      name: 'Concentration Limits',
      description: 'Risk concentration limits by sector, geography, and rating',
      domain: 'Credit Risk',
      owner: 'Credit Risk Policy Team',
      piiLevel: 'NONE',
      jurisdiction: 'GLOBAL',
      freshnessSLA: 'WEEKLY',
      sampleRowCount: 500,
      columns: [
        {
          name: 'limit_id',
          type: 'string',
          description: 'Unique limit identifier',
          nullable: false,
        },
        {
          name: 'limit_type',
          type: 'string',
          description: 'Type of concentration (SECTOR, GEOGRAPHY, RATING, SINGLE_BORROWER)',
          nullable: false,
        },
        {
          name: 'limit_category',
          type: 'string',
          description: 'Specific category within type',
          nullable: false,
        },
        {
          name: 'limit_amount',
          type: 'decimal',
          description: 'Maximum exposure in USD',
          nullable: false,
        },
        {
          name: 'limit_percentage',
          type: 'decimal',
          description: 'Maximum as percentage of total portfolio',
          nullable: true,
        },
        {
          name: 'current_exposure',
          type: 'decimal',
          description: 'Current exposure in USD',
          nullable: false,
        },
        {
          name: 'utilization_percentage',
          type: 'decimal',
          description: 'Current utilization percentage',
          nullable: false,
        },
        {
          name: 'breach_flag',
          type: 'boolean',
          description: 'True if limit is breached',
          nullable: false,
        },
        {
          name: 'effective_date',
          type: 'date',
          description: 'When limit became effective',
          nullable: false,
        },
      ],
    },
  ],
  glossary: [
    {
      term: 'Non-Performing Loan (NPL)',
      definition: 'A loan where the borrower is more than 90 days past due on principal or interest payments',
      domain: 'Credit Risk',
      synonyms: ['Non-performing Asset', 'NPA', 'Distressed Loan'],
      relatedDatasets: ['cr_loan_portfolio'],
    },
    {
      term: 'Probability of Default (PD)',
      definition: 'The likelihood that a borrower will default on their loan obligations within a specified time horizon, typically 12 months',
      domain: 'Credit Risk',
      synonyms: ['Default Probability'],
      relatedDatasets: ['cr_loan_portfolio'],
    },
    {
      term: 'Loss Given Default (LGD)',
      definition: 'The percentage of exposure that is expected to be lost if a borrower defaults, after accounting for collateral recovery',
      domain: 'Credit Risk',
      synonyms: ['Loss Severity'],
      relatedDatasets: ['cr_loan_portfolio'],
    },
    {
      term: 'Exposure at Default (EAD)',
      definition: 'The total amount that a bank is exposed to at the time a borrower defaults',
      domain: 'Credit Risk',
      synonyms: ['Credit Exposure'],
      relatedDatasets: ['cr_loan_portfolio'],
    },
    {
      term: 'Expected Credit Loss (ECL)',
      definition: 'The probability-weighted estimate of credit losses over the expected life of a financial instrument, calculated as PD × LGD × EAD',
      domain: 'Credit Risk',
      synonyms: ['Credit Loss Provision', 'IFRS 9 Loss'],
      relatedDatasets: ['cr_loan_portfolio'],
    },
    {
      term: 'Loan-to-Value Ratio (LTV)',
      definition: 'The ratio of the loan amount to the appraised value of the collateral, expressed as a percentage',
      domain: 'Credit Risk',
      synonyms: ['LTV', 'Collateral Coverage'],
      relatedDatasets: ['cr_loan_portfolio'],
    },
    {
      term: 'Concentration Risk',
      definition: 'The risk that a significant portion of the portfolio is exposed to a single borrower, sector, geography, or risk factor',
      domain: 'Credit Risk',
      synonyms: ['Portfolio Concentration'],
      relatedDatasets: ['cr_concentration_limits'],
    },
    {
      term: 'Rating Migration',
      definition: 'The transition of a loan or borrower from one credit rating category to another over time',
      domain: 'Credit Risk',
      synonyms: ['Credit Migration', 'Rating Transition'],
      relatedDatasets: ['cr_rating_migration'],
    },
  ],
  policies: [
    {
      id: 'pol_cr_high_pii',
      name: 'Credit Risk High PII Protection',
      description: 'Restrict access to loan portfolio borrower identifiable information',
      scope: 'dataset',
      targetDatasets: ['cr_loan_portfolio'],
      conditions: {
        piiLevel: ['HIGH'],
      },
      actions: {
        allow: ['RISK_ANALYST', 'RISK_MANAGER', 'COMPLIANCE_OFFICER'],
        deny: ['GUEST', 'VIEWER'],
        require_approval: true,
        mask_columns: ['borrower_id'],
      },
    },
    {
      id: 'pol_cr_concentration_alert',
      name: 'Concentration Breach Alert',
      description: 'Alert when concentration limits are approached or breached',
      scope: 'dataset',
      targetDatasets: ['cr_concentration_limits'],
      conditions: {},
      actions: {
        allow: ['RISK_ANALYST', 'RISK_MANAGER', 'CREDIT_OFFICER'],
      },
    },
    {
      id: 'pol_cr_npl_monitoring',
      name: 'NPL Portfolio Monitoring',
      description: 'Daily monitoring required for non-performing loans',
      scope: 'dataset',
      targetDatasets: ['cr_loan_portfolio'],
      conditions: {},
      actions: {
        allow: ['RISK_ANALYST', 'RISK_MANAGER', 'WORKOUT_SPECIALIST'],
      },
    },
  ],
  sampleQuestions: [
    {
      question: 'What is the total NPL ratio for commercial loans?',
      expectedIntent: {
        measures: ['npl_count', 'total_loans', 'npl_ratio'],
        dimensions: ['loan_type'],
        filters: {
          loan_type: 'COMMERCIAL',
          npl_flag: 'true',
        },
      },
      expectedDatasets: ['cr_loan_portfolio'],
      requiresApproval: false,
    },
    {
      question: 'Show me the expected credit loss by industry sector for loans rated below BBB',
      expectedIntent: {
        measures: ['sum_expected_credit_loss', 'sum_current_balance', 'ecl_percentage'],
        dimensions: ['industry_sector'],
        filters: {
          risk_rating: 'BB,B,CCC,CC,C,D',
        },
      },
      expectedDatasets: ['cr_loan_portfolio'],
      requiresApproval: false,
    },
  ],
  metadata: {
    version: '1.0.0',
    created: '2024-01-15',
    author: 'AUREUS Platform Team',
    tags: ['credit-risk', 'portfolio-monitoring', 'basel', 'ifrs9'],
  },
}
